{% extends 'base.html' %}
{% load static %}
{% block title %}Página principal{% endblock %}
{% block icon-page %}
metismenu-icon lnr-apartment icon-gradient bg-sunny-morning
{% endblock %}
{% block title-page %}
Página inicial
{% endblock %}
{% block description-page %}
Acompanhe as últimas notícias!
{% endblock %}
{% block content %}

<style type="text/css">
   .corfont{
   color: #641108;
   font-weight: bold;
   }
</style>

<div class="breadcrumbs-dark pb-0 pt-4" id="breadcrumbs-wrapper">
<div class="container">
   <div class="card" >
      <div class="card-content" style="margin-top: -40px;">
         <h5 class="corfont">CADASTRAR PARCEIRO</h5>
      </div>
   </div>
</div>
<div class="container">
   <div class="card" >
         <!-- Externo -->
      <div id="userint" class="row" >
        <div class="col s12"  style="margin-top: 30px;">
          <div class="input-field col s5">
             <input id="name" type="text" >
             <label for="name">
             <i class="material-icons" style="font-size: 15px">person</i>&nbsp;Nome Complemento</label>
          </div>
          <div class="input-field col s3">
            <input id="rn" type="text" >
            <label for="rn">
            <i class="material-icons" style="font-size: 15px">featured_play_list</i>&nbsp;NC</label>
         </div>
         <div class="input-field col s3" >
            <div class="select-wrapper">
              <select name="select" id="categoria" onchange="SelectShow()" class="error " required="">
                  <option value="SELECIONE">Categoria</option>
                  {% for k in arr_SearchCategoria %}
                  <option value="{{ k.id }}">{{ k.categoria }}</option>
                  {% endfor %}
              </select>
            </div>
        </div>
       </div>
       <div class="col s12">
          <div class="input-field col s8">
             <input id="email" type="email" >
             <label for="email">
             <i class="material-icons" style="font-size: 15px">email</i>&nbsp;E-mail</label>
          </div>
          <div class="input-field col s2">
             <input id="tel1" type="tel" >
             <label for="tel1">
             <i class="material-icons" style="font-size: 15px">phone</i>&nbsp;Telefone 1</label>
          </div>
          <div class="input-field col s2">
             <input id="tel2" type="tel" >
             <label for="tel2">
             <i class="material-icons" style="font-size: 15px">phone</i>&nbsp;Telefone 2</label>
          </div>
       </div>
       <div class="col s12">
          <div class="input-field col s3">
             <input id="zipcode" type="text"  maxlength="9" onblur="pesquisacep(this.value)">
             <label for="zipcode">
             <i class="material-icons" style="font-size: 15px">place</i>&nbsp;CEP </label>
          </div>
          <div class="input-field col s7">
             <input id="addres" type="text" >
             <label for="addres">Logradouro </label>
          </div>
          <div class="input-field col s2">
             <input id="number" type="text" >
             <label for="number">Número </label>
          </div>
       </div> 
       <div class="col s12">
         <div class="input-field col s3">
            <input id="complement" type="text" >
            <label for="complement">Complemento</label>
         </div>
         <div class="input-field col s5">
           <input id="district" type="text" >
           <label for="district">Bairro</label>
        </div>
         <div class="input-field col s2">
           <input id="city" type="text" >
           <label for="city">Cidade</label>
        </div>
        <div class="input-field col s2">
           <input id="uf" type="text"  maxlength="2">
           <label for="uf">UF</label>
        </div>
      
       </div>
       <div class="input-field col s12">
         <div class="input-field col s12">
            <input id="obs" type="text" >
            <label for="obs">
               <i class="material-icons" style="font-size: 15px">mode_edit</i>&nbsp;Observação</label>
         </div>
      </div>
        

         <!--BUTTON-->
         <div class="col s12 ">
            <div class="col s12 mb-2">
               <button disabled onclick="CadastrePartners()"id="btn_cadastrar" class="waves-effect waves dark btn next-step" type="submit" style="width: 100%; margin-top: 10px">
               <span style="font-weight: bold; color: white; font-family:Verdana, Geneva, Tahoma, sans-serif">Cadastrar</spanpx>
               </button>
            </div>
         </div>
      </div>
   </div>
</div>




<script type="text/javascript">

function SelectShow() {
  var show = document.getElementById("categoria").value;
      $("#btn_cadastrar").attr("disabled", true);   
      
      if(show == 'SELECIONE'){
         alert("Por favor, preencha um tipo de Categoria")
        }else{
      $("#btn_cadastrar").attr("disabled", false);
        }
}

      $("#tel1").mask("(00) 00000-0000");
      $("#tel2").mask("(00) 00000-0000");
      $("#zipcode").mask("00000-000");
   
   
     function CadastrePartners(){
   
         var categoria = $("#categoria").val();
         var name = $("#name").val();
         var email = $("#email").val();
         var tel1 = $("#tel1").val();
         var tel2 = $("#tel2").val();
         var zipcode = $("#zipcode").val();
         var addres = $("#addres").val();
         var number = $("#number").val();
         var complement = $("#complement").val();
         var district = $("#district").val();
         var city = $("#city").val();
         var uf = $("#uf").val();
         var rn = $("#rn").val();
         var categoria = $("#categoria").val();
         var obs = $("#obs").val();
   
    
   
      //VALIDAÇÃO DE CAMPO NULL  
      if(document.getElementById('name').value == ''){
            alert('Por favor, preencha o campo Nome')
            txt = 'name';
            return false;
         } else if(document.getElementById('rn').value == ''){
         alert('Por favor, preencha o campo RN')
            txt = 'rn';
            return false;
         }else if(document.getElementById('categoria').value == ''){
         alert('Por favor, preencha o campo Categoria')
            txt = 'categoria';
            return false;
         }else if(document.getElementById('email').value == ''){
         alert('Por favor, preencha o campo E-mail')
            txt = 'email';
            return false;
         }else if(document.getElementById('tel1').value == ''){
         alert('Por favor, preencha o campo Telefone 1')
            txt = 'tel1'; 
            return false;
         } else if(document.getElementById('zipcode').value == ''){
         alert('Por favor, preencha o campo CEP')
            txt = 'zipcode';
            return false;
         }else if(document.getElementById('addres').value == ''){
         alert('Por favor, preencha o campo Logradouro')
            txt = 'addres';
            return false;
         }else if(document.getElementById('number').value == ''){
         alert('Por favor, preencha o campo Número')
            txt = 'number';
            return false;
         }else if(document.getElementById('district').value == ''){
         alert('Por favor, preencha o campo Bairro')
            txt = 'district';
            return false;
         }else if(document.getElementById('uf').value == ''){
         alert('Por favor, preencha o campo UF')
            txt = 'uf';
            return false;
         }
         
         var btncadastrar = {"csrfmiddlewaretoken": $('input[name="csrfmiddlewaretoken"]').val(), 
            "categoria": $('#categoria').val(), 
            "name": $('#name').val(),
            "email": $('#email').val(),
            "tel1": $('#tel1').val(),
            "tel2": $('#tel2').val(),
            "zipcode": $('#zipcode').val(),
            "addres": $('#addres').val(),
            "number": $('#number').val(),
            "complement": $('#complement').val(),
            "district": $('#district').val(),
            "city": $('#city').val(),
            "uf": $('#uf').val(),
            "rn": $('#rn').val(),
            "categoria": $('#categoria').val(),
            "obs": $('#obs').val(),
            };
   
         fetchRequest("{% url 'ApiCadastrePartnes' %}", "POST", "JSON", btncadastrar, function(re){
            if(re["response"] == "true"){
               alert(re["message"]);
               location.reload();
         }   
      });
   };
   
   
   // CEP 
   function pesquisacep(valor) {
      var cep = valor.replace(/\D/g, '');
   
      if (cep != "") {
         var validacep = /^[0-9]{8}$/;
         if(validacep.test(cep)) {
            var end_addres = $("#addres").val("...");
            var end_district = $("#district").val("...");
            var end_city = $("#city").val("...");
            var end_state = $("#uf").val("...");
            var script = document.createElement('script');
   
            script.src = 'https://viacep.com.br/ws/'+ cep + '/json/?callback=bsccep';
            document.body.appendChild(script);
         } 
         else {
            limocamp();
            alert("Formato de CEP inválido.");
         }
      }
      else {
         limocamp();
      }
      };
   
   function bsccep(val) {
      if (!("erro" in val)) {
         var end_addres = $("#addres").val(val.logradouro);
         var end_district = $("#district").val(val.bairro);
         var end_city = $("#city").val(val.localidade);
         var end_state = $("#uf").val(val.uf);
      } 
      else {
         limocamp();
         alert("CEP não encontrado no CORREIOS. Entre no site: https://www.correios.com.br/ e pesquise um cep válido.");
      }
   }
   
   function limocamp() {
   var end_zipcode = $("#zipcode").val("");
   var end_addres = $("#addres").val("");
   var end_number = $("#number").val("");
   var end_district = $("#district").val("");
   var end_city = $("#city").val("");
   var end_state = $("#uf").val("");
   }
   
   
   
   
   
   </script>

{% endblock %}